#correcte
#Mxee2=np.array([[(L2**4*np.cos(q1 + q2)**2 + L2**2*m2*np.cos(q1 + q2)**2 - L2**4*m2*np.cos(q1 + q2)**2 + L1**2*m2*np.cos(q1)**2 + L1**2*L2**2*np.cos(q1)**2 + L1**2*L2**2*m1*np.cos(q1 + q2)**2 + L1**2*L2**2*m2*np.cos(q1 + q2)**2 + 2*L1*L2**3*np.cos(q1 + q2)*np.cos(q1) - 2*L1*L2**3*m2*np.cos(q1 + q2)*np.cos(q1) + 2*L1*L2*m2*np.cos(q1 + q2)*np.cos(q1) - 2*L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1)),(L2**4*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*m2*np.cos(q1)*np.sin(q1) + L1**2*L2**2*np.cos(q1)*np.sin(q1) + L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) - L2**4*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2**3*np.cos(q1 + q2)*np.sin(q1) + L1*L2**3*np.sin(q1 + q2)*np.cos(q1) - L1*L2**3*m2*np.cos(q1 + q2)*np.sin(q1) - L1*L2**3*m2*np.sin(q1 + q2)*np.cos(q1) + L1**2*L2**2*m1*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2*m2*np.cos(q1 + q2)*np.sin(q1) + L1*L2*m2*np.sin(q1 + q2)*np.cos(q1) - L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q2)*np.sin(q1) - L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1))],[(L2**4*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*m2*np.cos(q1)*np.sin(q1) + L1**2*L2**2*np.cos(q1)*np.sin(q1) + L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) - L2**4*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2**3*np.cos(q1 + q2)*np.sin(q1) + L1*L2**3*np.sin(q1 + q2)*np.cos(q1) - L1*L2**3*m2*np.cos(q1 + q2)*np.sin(q1) - L1*L2**3*m2*np.sin(q1 + q2)*np.cos(q1) + L1**2*L2**2*m1*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2*m2*np.cos(q1 + q2)*np.sin(q1) + L1*L2*m2*np.sin(q1 + q2)*np.cos(q1) - L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q2)*np.sin(q1) - L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1)),(L2**4*np.sin(q1 + q2)**2 + L2**2*m2*np.sin(q1 + q2)**2 - L2**4*m2*np.sin(q1 + q2)**2 + L1**2*m2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1)**2 + L1**2*L2**2*m1*np.sin(q1 + q2)**2 + L1**2*L2**2*m2*np.sin(q1 + q2)**2 + 2*L1*L2**3*np.sin(q1 + q2)*np.sin(q1) - 2*L1*L2**3*m2*np.sin(q1 + q2)*np.sin(q1) + 2*L1*L2*m2*np.sin(q1 + q2)*np.sin(q1) - 2*L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q2)*np.sin(q1))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1))]])

#erreur
#Mxee2=np.array([[(L2**4*np.cos(q1 + q2)**2 + L2**2*m2*np.cos(q1 + q2)**2 - L2**4*m2*np.cos(q1 + q2)**2 + L1**2*m2*np.cos(q1)**2 + L1**2*L2**2*np.cos(q1)**2 + L1**2*L2**2*m1*np.cos(q1 + q2)**2 + L1**2*L2**2*m2*np.cos(q1 + q2)**2 + 2*L1*L2**3*np.cos(q1 + q2)*np.cos(q1) - 2*L1*L2**3*m2*np.cos(q1 + q2)*np.cos(q1) + 2*L1*L2*m2*np.cos(q1 + q2)*np.cos(q1) - 2*L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1)),-(L2**4*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*m2*np.cos(q1)*np.sin(q1) + L1**2*L2**2*np.cos(q1)*np.sin(q1) + L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) - L2**4*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2**3*np.cos(q1 + q2)*np.sin(q1) + L1*L2**3*np.sin(q1 + q2)*np.cos(q1) - L1*L2**3*m2*np.cos(q1 + q2)*np.sin(q1) - L1*L2**3*m2*np.sin(q1 + q2)*np.cos(q1) + L1**2*L2**2*m1*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2*m2*np.cos(q1 + q2)*np.sin(q1) + L1*L2*m2*np.sin(q1 + q2)*np.cos(q1) - L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q2)*np.sin(q1) - L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1))],
#	[-(L2**4*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*m2*np.cos(q1)*np.sin(q1) + L1**2*L2**2*np.cos(q1)*np.sin(q1) + L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) - L2**4*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2**3*np.cos(q1 + q2)*np.sin(q1) + L1*L2**3*np.sin(q1 + q2)*np.cos(q1) - L1*L2**3*m2*np.cos(q1 + q2)*np.sin(q1) - L1*L2**3*m2*np.sin(q1 + q2)*np.cos(q1) + L1**2*L2**2*m1*np.cos(q1 + q2)*np.sin(q1 + q2) + L1**2*L2**2*m2*np.cos(q1 + q2)*np.sin(q1 + q2) + L1*L2*m2*np.cos(q1 + q2)*np.sin(q1) + L1*L2*m2*np.sin(q1 + q2)*np.cos(q1) - L1**2*L2**2*m2*np.cos(q1 + q2)*np.cos(q2)*np.sin(q1) - L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q1)*np.cos(q2))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1)),(L2**4*np.sin(q1 + q2)**2 + L2**2*m2*np.sin(q1 + q2)**2 - L2**4*m2*np.sin(q1 + q2)**2 + L1**2*m2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1)**2 + L1**2*L2**2*m1*np.sin(q1 + q2)**2 + L1**2*L2**2*m2*np.sin(q1 + q2)**2 + 2*L1*L2**3*np.sin(q1 + q2)*np.sin(q1) - 2*L1*L2**3*m2*np.sin(q1 + q2)*np.sin(q1) + 2*L1*L2*m2*np.sin(q1 + q2)*np.sin(q1) - 2*L1**2*L2**2*m2*np.sin(q1 + q2)*np.cos(q2)*np.sin(q1))/(L1**2*L2**2*np.cos(q1 + q2)**2*np.sin(q1)**2 + L1**2*L2**2*np.sin(q1 + q2)**2*np.cos(q1)**2 - 2*L1**2*L2**2*np.cos(q1 + q2)*np.sin(q1 + q2)*np.cos(q1)*np.sin(q1))]])
 
 
 
 def osc_V2(q1,q2,w1,w2,x_error,y_error):
	#data robot
	L1=0.1
	L2=0.1
	r=0.01
	mv=1000
	V_tube=np.pi*r*r*L1
	V_sphere=4/3*np.pi*r*r*r
	m1=(V_tube+V_sphere)*mv
	m2=m1
	Kp=6
	
	theta_dot=np.array([[w1],[w2]])
	
	#jacobienne a l' OT
	
	Jee=np.array([[-L1*np.sin(q1)-L2*np.sin(q1+q2) , -L2*np.sin(q1+q2)],
	[L1*np.cos(q1)+L2*np.cos(q1+q2) , L2*np.cos(q1+q2)]])
	
	
	#position et vitesse du robot
	X=np.array([[L1*np.cos(q1)+L2*np.cos(q1+q2)],[L1*np.sin(q1)+L2*np.sin(q1+q2)]])
	
	nu=np.dot(Jee,theta_dot) 
	
	#matrice d'inertie du robot
	M=np.array([[m1*L1**2+m2*(L1**2+2*L1*L2*np.cos(q2)+L2**2),m2*(L1*L2*np.cos(q2)+L2**2)],
	[m2*(L1*L2*np.cos(q2)+L2**2),m2*L2**2]])
	
	#matrice d'inertie au niveau de l'OT
	#Mxee=np.linalg.inv(np.dot(Jee,np.dot(np.linalg.inv(M),np.transpose(Jee))))
	J_T=np.transpose(Jee)
	J_inv=np.linalg.inv(Jee)
	J_t_inv=np.transpose(J_inv)
	Lambda=np.dot(J_t_inv,np.dot(M,J_inv)) #A(theta) 
	
	h=np.array([[-m2*L1*L2*np.sin(q2)*(2*w1*w2+w2**2)],[m2*L1*L2*w1**2*sin(q2)]])
	
	eta=np.dot(J_t_inv,h)-np.dot(np.dot(Lambda,J_dot),theta_dot)
	
	#F=Meex*x_point_point
	Fx=np.dot(Lambda,nu_dot)+eta
	
	#u=JeeT*Fx
	
	U=np.dot(J_T,Fx)
	
	return U	
	
	
	
	print(np_random.uniform(low=-0.2, high=0.2, size=2))
	
	
	
